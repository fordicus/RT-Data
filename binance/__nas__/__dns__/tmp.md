### ν•μ¤„ μ”μ•½

WireGuard(μ‚¬μ„¤ VPN)λ§ μ“°κΈ°λ΅ ν–λ‹¤λ©΄ **Cloudflare**μ—μ„λ” *κ±°μ μ†λ κ² μ—†λ‹¤*.
λ‚¨λ” μΌμ€ β€DNS-Only (νμƒ‰ κµ¬λ¦„) A/AAAA λ μ½”λ“ μ μ§€ + IP μλ™κ°±μ‹  μ¤ν¬λ¦½νΈβ€ μ •λ„μ•Ό.

---

## ν•΄μ•Ό ν• (λλ” μ• ν•΄λ„ λλ”) μΌ μ²΄ν¬λ¦¬μ¤νΈ

| κµ¬λ¶„                                  | ν•΄μ•Ό ν•  κ²ƒ                                                                                                                      | μ™/μ–Έμ  ν•„μ”ν•κ°€                                                         |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------- |
| **1. DNS Proxy ν•΄μ **                 | `rdp.sognex.com`, `sftp.sognex.com`μ„ **DNS Only**(νμƒ‰ κµ¬λ¦„)λ΅ λ‘κΈ° <br>β€“ *HTTPκ°€ μ•„λ‹λ©΄ Orange-Proxyκ°€ νΈλν”½μ„ λ§‰μ* ([Cloudflare Docs][1]) | RDPΒ·SFTPλ” 3389/22 TCPλ¥Ό μ§μ ‘ μ“°μ§€λ§, μ΄μ  μ™Έλ¶€ ν¬νΈλ” μ°¨λ‹¨λΌ μμ–΄. β€DNS ν•΄κ²°λ§β€ ν•΄μ£Όλ©΄ μ¶©λ¶„ |
| **2. A/AAAA λ μ½”λ“ μ μ§€**                | μ—¬μ „ν **κ³µμΈ IP**(λλ” DDNS)λ¥Ό κ°€λ¦¬ν‚¤λ„λ΅ μ μ§€ <br>β€“ μƒλ΅μ΄ **vpn.sognex.com** μ„λΈλ„λ©”μΈμ„ λ§λ“¤μ–΄ WireGuard 51820/UDP μ©μΌλ΅ μ¨λ„ OK                      | ν΄λΌμ΄μ–ΈνΈκ°€ WireGuardμ— λ¶™μ„ λ• μ΄ μ£Όμ†λ¥Ό μ°Έμ΅°                                   |
| **3. Cloudflare IP ν™”μ΄νΈλ¦¬μ¤νΈ μ κ±°**      | UFWμ—μ„ `<Cloudflare IP Ranges>` ν—μ© λ£¨ν”„λ¥Ό ν†µμ§Έλ΅ μ‚­μ                                                                                 | μ™Έλ¶€ 3389/22 ν¬νΈλ¥Ό μ™„μ „ν λ‹«μ•μΌλ‹, Cloudflare IPλ§ μ—΄μ–΄ λ‘λ” μ •μ±… μμ²΄κ°€ λ¶ν•„μ”          |
| **4. DDNS μ¤ν¬λ¦½νΈ κ·Έλ€λ΅ μ‚¬μ©**             | κ°€μ •μ© νμ„ μ΄λΌ IPκ°€ λ³€ν•λ©΄ **Cloudflare API**λ΅ Aλ μ½”λ“ μ—…λ°μ΄νΈν•λ” κΈ°μ΅΄ νμ΄μ¬ μ¤ν¬λ¦½νΈ μ μ§€                                                             | WireGuardλ„ κ²°κµ­ κ³µμΈ IPλ΅ μ ‘μ†ν•λ―€λ΅, λ μ½”λ“ μµμ‹ ν™”κ°€ κ³„μ† ν•„μ”                        |
| **5. (μ„ νƒ) Zero Trust/ Argo Tunnel** | WireGuardκ°€ μ΄λ―Έ ν¬νΈλ¥Ό 0κ°λ΅ λ§λ“λ” μ—­ν• μ„ ν•λ―€λ΅, <br>Cloudflare TunnelΒ·Accessλ΅ RDP/SSHλ¥Ό ν”„λ΅μ‹ν•  **μ¶”κ°€ μ΄λ“μ€ μ μ**                                | λ‹¨, μ‚¬λ‚΄Β·λ¨λ°”μΌ λ””λ°”μ΄μ¤λ§λ‹¤ λ³„λ„ VPNμ„ κΉ”κΈ° μ‹«λ‹¤λ©΄ λ€μ•μ΄ λ  μ μμ                        |

> **μ΄λ―Έ κ°€μ΄λ“μ— μλ β€ν–¥ν›„ TODO β†’ WireGuard λ„μ…β€μ„ μ‹¤ν–‰ν–μΌλ‹, <br>Cloudflare λ³΄μ• κ·μΉ™ μλ™ κ°±μ‹  μ‘μ—…(TODO)λ„ μ‚¬μ‹¤μƒ λ¬΄μλ―Έν•΄μ΅μ–΄.**&#x20;

---

## λ³€κ²½ ν›„ λ™μ‘ νλ¦„

1. **ν΄λΌμ΄μ–ΈνΈ**

   1. `wg-quick up client.conf` β†’ VPN ν„°λ„ ν•μ„±
   2. λ‚΄λ¶€ DNS(μ¤ν”λ¦Ώ DNS)λ“  μ™Έλ¶€ DNSλ“  `rdp.sognex.com` β†’ **10.0.0.1** λ΅ ν•΄μ„
   3. `mstsc / sftp` ν΄λΌμ΄μ–ΈνΈκ°€ 10.0.0.1:3389/22 μ ‘μ†

2. **Cloudflare**

   * *λ‹¨μ κ¶μ„ DNS* λ΅μ„ μ§μμ— IPλ§ μ‘λ‹µ
   * HTTP/S νΈλν”½λ§ Orange-Proxy(WAF, CDN) μ μ© κ°€λ¥

3. **μ„λ²„/λΌμ°ν„°**

   * μ™Έλ¶€μ—μ„ μ—΄λ ¤ μλ” κ²ƒμ€ **51820/UDP ν• ν¬νΈ**λΏ
   * UFWλ„ β€51820/udp allowβ€ ν• μ¤„μ΄λ©΄ λ

---

## μ–΄λ¦°μ΄ μ„¤λ… π¬

β€ν΄λΌμ°λ“ν”λ μ–΄λ” μ΄μ  **μ£Όμ† μ•λ‚΄μ†** μ—­ν• λ§ ν•΄. μΉκµ¬(ν΄λΌμ΄μ–ΈνΈ)κ°€ β€μ§‘(μ„λ²„) μ£Όμ†β€™ λ¬»μΌλ©΄ β€μ—¬κΈ°μ•Ό!β€™ ν•κ³  λ²νΈλ§ κ°€λ¥΄μ³ μ£Όκ³ , λ¬Έλ‹¨μ†(ν¬νΈ μ—¬λ‹«κΈ°)μ€ WireGuardκ°€ λ‹¤ ν•΄ μ£Όλ‹κΉ λ”λ” λ„μ™€μ¤„ μΌμ΄ μ—†μ§€!β€

---

### κ²°λ΅ 

* **Cloudflareμ—μ„  DNS λ μ½”λ“λ§ μ μ μ§€**ν•λ©΄ λ.
* UFW ν™”μ΄νΈλ¦¬μ¤νΈΒ·Proxy μƒνƒ κ°™μ€ λ³µμ΅ν• μ„¤μ •μ€ **WireGuardκ°€ λ“±μ¥ν•λ©΄μ„ ν•„μ” μ—†μ–΄μ΅λ‹¤**.
  μ¦‰, ν„μ¬ μ„Έν… κΈ°μ¤€μΌλ΅λ” λ³„λ„ μ¶”κ°€ μ‘μ—… μ—†λ‹¤β€”β€DNS Onlyβ€™λ§ ν™•μΈν•κ³  νΈν μ‰¬μ–΄λ„ λΌ!

[1]: https://developers.cloudflare.com/dns/proxy-status/?utm_source=chatgpt.com "Proxy status - DNS"
