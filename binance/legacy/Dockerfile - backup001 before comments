# Dockerfile
FROM python:3.11-slim

WORKDIR /app

# Install system deps
RUN apt-get update && apt-get install -y \
    build-essential curl zip git && \
    pip install --upgrade pip

# Copy requirements and install
COPY requirements.txt .
RUN pip install -r requirements.txt pyinstaller

# Copy source code
COPY . .

# Build binary
RUN pyinstaller --onefile --clean --noconfirm --log-level=WARN --hidden-import=jinja2 --add-data "templates:templates" stream_binance.py

CMD cp dist/stream_binance /app/stream_binance.built

# Run in Windows CMD:
#     docker build -t pyinstaller-stream-binance .
#     docker run --rm -v %cd%:/app pyinstaller-stream-binance
